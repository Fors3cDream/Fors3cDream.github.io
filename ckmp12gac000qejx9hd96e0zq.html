<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="Hexo Theme Keep">
    <meta name="author" content="Fors3c">
    
    <title>
        
            Go数组、切片、映射和结构体 |
        
        Fors3c&#39;s技术小木屋
    </title>
    <link rel="stylesheet" href="/css/style.css">
    <link rel="shortcut icon" href="/images/logo.svg">
    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"fors3cdream.github.io","root":"/","language":"zh-CN","path":"search.xml"};
    KEEP.theme_config = {"toc":{"enable":false,"number":false,"expand_all":false,"init_open":false},"style":{"primary_color":"#0066CC","avatar":"/images/avatar.svg","favicon":"/images/logo.svg","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":true,"background_img":"/images/bg.svg","description":"保持好奇，保持学习，保持对技术的热诚！"},"scroll":{"progress_bar":{"enable":false},"percent":{"enable":false}}},"local_search":{"enable":false,"preload":false},"code_copy":{"enable":false,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":false},"version":"3.4.1"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 5.4.0">
<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
</head>


<body>
<div class="progress-bar-container">
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            <a class="logo-title" href="/">
                Fors3c&#39;s技术小木屋
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                    
                </ul>
            </div>
            <div class="mobile">
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">Go数组、切片、映射和结构体</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="/images/avatar.svg">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">Fors3c</span>
                        
                            <span class="author-label">Lv2</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2021-03-25 23:03:02
    </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/Go/">Go</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h3 id="Go数组、切片、映射和结构体"><a href="#Go数组、切片、映射和结构体" class="headerlink" title="Go数组、切片、映射和结构体"></a>Go数组、切片、映射和结构体</h3><h4 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h4><p>Go中的数组是一种特定类型且长度固定的数据结构。可以具有零个或多个元素，必须在声明或初始化是定义大小。数组一旦创建，就无法调整大小。</p>
<p>数组在Go程序中并不常用，但它是切片和映射的基础。</p>
<h5 id="声明数组"><a href="#声明数组" class="headerlink" title="声明数组"></a>声明数组</h5><p>Go中声明数组，必须定义元素的类型以及数组中元素的个数。然后，可以采用下标表示法访问数组中的每个元素（从0开始）。</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    <span class="keyword">var</span> a [<span class="number">3</span>]<span class="keyword">int</span></span><br><span class="line">    a[<span class="number">1</span>] = <span class="number">10</span></span><br><span class="line">    fmt.Println(a[<span class="number">0</span>])</span><br><span class="line">    fmt.Println(a[<span class="number">1</span>])</span><br><span class="line">    fmt.Println(a[<span class="built_in">len</span>(a)<span class="number">-1</span>])</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>以上代码运行时输出如下：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">0</span><br><span class="line">10</span><br><span class="line">0</span><br></pre></td></tr></tbody></table></figure>

<p>默认情况下，Go会使用数组元素对应的类型的默认值初始化每个元素。</p>
<h5 id="初始化数组"><a href="#初始化数组" class="headerlink" title="初始化数组"></a>初始化数组</h5><p>声明数组时，可以使用非默认值来初始化数组。示例如下：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cities := [<span class="number">5</span>]<span class="keyword">string</span>{<span class="string">"New York"</span>, <span class="string">"Paris"</span>, <span class="string">"Berlin"</span>, <span class="string">"Madrid"</span>}</span><br></pre></td></tr></tbody></table></figure>

<p>如果初始化值个数没有数组元素个数多，则剩余的将以默认值进行初始化。</p>
<h5 id="数组中的省略号"><a href="#数组中的省略号" class="headerlink" title="数组中的省略号"></a>数组中的省略号</h5><p>如果不知道需要多少个元素，但知道将具有多少数据，那么还有一种声明和初始化数组的方法是使用省略号<code>...</code>。</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">q := [...]<span class="keyword">int</span>{<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>}</span><br></pre></td></tr></tbody></table></figure>

<p>完整示例：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    cities := [...]<span class="keyword">string</span>{<span class="string">"New York"</span>, <span class="string">"Paris"</span>, <span class="string">"Berlin"</span>, <span class="string">"Madrid"</span>}</span><br><span class="line">    fmt.Println(<span class="string">"Cities: "</span>, cities)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cities: [New York Paris Berlin Madrid]</span><br></pre></td></tr></tbody></table></figure>

<p>这种声明方式，数组长度由初始化时输入的字符串决定。另一种有趣的初始化方式是使用省略号并仅为最新的位置指定值。如下所示：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    numbers := [...]<span class="keyword">int</span>{<span class="number">99</span>: <span class="number">-1</span>}</span><br><span class="line">    fmt.Println(<span class="string">"First Position: "</span>, numbers[<span class="number">0</span>])</span><br><span class="line">    fmt.Prinlnt(<span class="string">"Last Position: "</span>, numbers[<span class="number">99</span>])</span><br><span class="line">    fmt.Println(<span class="string">"Length: "</span>, <span class="built_in">len</span>(numbers))</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出为：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">First Position: 0</span><br><span class="line">Last Position: -1</span><br><span class="line">Length: 100</span><br></pre></td></tr></tbody></table></figure>

<h4 id="多维数组"><a href="#多维数组" class="headerlink" title="多维数组"></a>多维数组</h4><p>如果需要处理复杂的数据结构，Go支持多维数组。</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main </span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    <span class="keyword">var</span> twoD [<span class="number">3</span>][<span class="number">5</span>]<span class="keyword">int</span> <span class="comment">// 声明3行5列的int数组</span></span><br><span class="line">    <span class="keyword">for</span> i:=<span class="number">0</span>; i&lt;<span class="number">3</span>; i++ {</span><br><span class="line">        <span class="keyword">for</span> j:=<span class="number">0</span>; j&lt;<span class="number">5</span>; j++ {</span><br><span class="line">            twoD[i][j] = (i+<span class="number">1</span>)*(j+<span class="number">1</span>)</span><br><span class="line">        }</span><br><span class="line">        fmt.Println(<span class="string">"Row"</span>, i, twoD[i])</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">"\nAll at once:"</span>, twoD)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>


<p>输出如下：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Row 0 [1 2 3 4 5]</span><br><span class="line">Row 1 [2 4 6 8 10]</span><br><span class="line">Row 2 [3 6 9 12 15]</span><br><span class="line"></span><br><span class="line">All at once: [[1 2 3 4 5] [2 4 6 8 10] [3 6 9 12 15]]</span><br></pre></td></tr></tbody></table></figure>

<p>上面声明了一个二维数组，可以将此数组看做一种包含行和列的数据结构。</p>
<h4 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h4><p>与数组一样，切片也表示一系列类型相同的元素。不过，切片的大小是动态的，不是固定的。</p>
<p>切片只是名为基础数组的数组之上的一种数据结构。通过切片，可以访问整个数组，也可仅访问部分元素。</p>
<p>切片只有3个组件：</p>
<ul>
<li><b>指针：</b>指向基础数组可访问的第一个元素（并非是数组的第一个元素）</li>
<li><b>长度：</b>指示切片中的元素数目</li>
<li><b>容量：</b>显示切片开头与基础数组结束之间的元素数目</li>
</ul>
<p><img src="https://docs.microsoft.com/zh-cn/learn/language/go-data-types/media/go-slices.png" alt="切片"></p>
<p>切片只是基础数组的一个子集。</p>
<h5 id="声明和初始化切片"><a href="#声明和初始化切片" class="headerlink" title="声明和初始化切片"></a>声明和初始化切片</h5><p>要声明切片，可采用与声明数组相同的方式操作。</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    months := []<span class="keyword">string</span>{<span class="string">"January"</span>, <span class="string">"February"</span>, <span class="string">"March"</span>, <span class="string">"April"</span>, <span class="string">"May"</span>, <span class="string">"June"</span>, <span class="string">"July"</span>, <span class="string">"August"</span>, <span class="string">"September"</span>, <span class="string">"October"</span>, <span class="string">"November"</span>, <span class="string">"December"</span>}</span><br><span class="line">    fmt.Println(months)</span><br><span class="line">    fmt.Println(<span class="string">"Length: "</span>, <span class="built_in">len</span>(months))</span><br><span class="line">    fmt.Println(<span class="string">"Capacity: "</span>, <span class="built_in">cap</span>(months))</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[January February March April May June July August September October November December]</span><br><span class="line">Length: 12</span><br><span class="line">Capacity: 12</span><br></pre></td></tr></tbody></table></figure>

<p>切片与数组的区别不大，可以用相同的方式声明。若要从切片中获取信息，可使用内置函数<code>len()</code>和<code>cap()</code>。</p>
<h5 id="切片项"><a href="#切片项" class="headerlink" title="切片项"></a>切片项</h5><p>Go支持切片运算符<code>s[i:j]</code>：</p>
<ul>
<li><code>s</code>表示数组或切片</li>
<li><code>i</code>表示指向它将使用的数组（或另一个切片）的第一个元素的指针</li>
<li><code>j</code>表示切片将使用的最后一个元素的位置</li>
</ul>
<p>切片只能引用元素的子集。例如，需要4个变量来表示一年的每个季度，如下图所示：</p>
<p><img src="https://docs.microsoft.com/zh-cn/learn/language/go-data-types/media/go-slices-multiple.png" alt="切片只能引用元素子集"></p>
<p>用代码表示如下：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    months := []<span class="keyword">string</span>{<span class="string">"January"</span>, <span class="string">"February"</span>, <span class="string">"March"</span>, <span class="string">"April"</span>, <span class="string">"May"</span>, <span class="string">"June"</span>, <span class="string">"July"</span>, <span class="string">"August"</span>, <span class="string">"September"</span>, <span class="string">"October"</span>, <span class="string">"November"</span>, <span class="string">"December"</span>}</span><br><span class="line">    quarter1 := months[<span class="number">0</span>:<span class="number">3</span>]</span><br><span class="line">    quarter2 := months[<span class="number">3</span>:<span class="number">6</span>]</span><br><span class="line">    quarter3 := months[<span class="number">6</span>:<span class="number">9</span>]</span><br><span class="line">    quarter4 := months[<span class="number">9</span>:<span class="number">12</span>]</span><br><span class="line">    fmt.Println(quarter1, <span class="built_in">len</span>(quarter1), <span class="built_in">cap</span>(quarter1))</span><br><span class="line">    fmt.Println(quarter2, <span class="built_in">len</span>(quarter2), <span class="built_in">cap</span>(quarter2))</span><br><span class="line">    fmt.Println(quarter3, <span class="built_in">len</span>(quarter3), <span class="built_in">cap</span>(quarter3))</span><br><span class="line">    fmt.Println(quarter4, <span class="built_in">len</span>(quarter4), <span class="built_in">cap</span>(quarter4)) </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出如下：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[January February March] 3 12</span><br><span class="line">[April May June] 3 9</span><br><span class="line">[July August September] 3 6</span><br><span class="line">[October November December] 3 3</span><br></pre></td></tr></tbody></table></figure>

<p>注意，切片的长度不变，但容量不同。比如<code>quarter2</code>切片，从位置3开始，最后一个元素是位置6。切片长度为3个元素，但容量为9，因为基础数组有更多元素或位置可以使用，但对切片而言不可见，如果使用<code>quarter2[3]</code>访问元素，会报错。</p>
<p>切片容量仅指出切片可扩展的成都。比如可以从<code>quarter2</code>扩展切片：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    months := []<span class="keyword">string</span>{<span class="string">"January"</span>, <span class="string">"February"</span>, <span class="string">"March"</span>, <span class="string">"April"</span>, <span class="string">"May"</span>, <span class="string">"June"</span>, <span class="string">"July"</span>, <span class="string">"August"</span>, <span class="string">"September"</span>, <span class="string">"October"</span>, <span class="string">"November"</span>, <span class="string">"December"</span>}</span><br><span class="line">    quarter2 := months[<span class="number">3</span>:<span class="number">6</span>]</span><br><span class="line">    quarter2Extended := quarter2[:<span class="number">4</span>]</span><br><span class="line">    fmt.Println(quarter2, <span class="built_in">len</span>(quarter2), <span class="built_in">cap</span>(quarter2))</span><br><span class="line">    fmt.Println(quarter2Extended, <span class="built_in">len</span>(quarter2Extended), <span class="built_in">cap</span>(quarter2Extended))</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出如下：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[April May June] 3 9</span><br><span class="line">[April May June July] 4 9</span><br></pre></td></tr></tbody></table></figure>

<h5 id="追加项"><a href="#追加项" class="headerlink" title="追加项"></a>追加项</h5><p>切片与数组的区别中，第一个是切片的大小不是固定的，是动态的。创建切片后，可以向其添加更多元素，这样切片就会扩展。</p>
<p>Go提供内置函数<code>append(slice, element)</code>，便于向切片添加元素。<code>append</code>函数会返回一个新的切片，需要将其存储在变量中。对于要更改的切片，变量可能相同。</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    <span class="keyword">var</span> numbers []<span class="keyword">int</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i&lt;<span class="number">10</span>; i++ {</span><br><span class="line">        numbers = <span class="built_in">append</span>(numbers, i)</span><br><span class="line">        fmt.Printf(<span class="string">"%d\tcap=%d\t%v\n"</span>, i, <span class="built_in">cap</span>(numbers), numbers)</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出如下：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">0       cap=1   [0]</span><br><span class="line">1       cap=2   [0 1]</span><br><span class="line">2       cap=4   [0 1 2]</span><br><span class="line">3       cap=4   [0 1 2 3]</span><br><span class="line">4       cap=8   [0 1 2 3 4]</span><br><span class="line">5       cap=8   [0 1 2 3 4 5]</span><br><span class="line">6       cap=8   [0 1 2 3 4 5 6]</span><br><span class="line">7       cap=8   [0 1 2 3 4 5 6 7]</span><br><span class="line">8       cap=16  [0 1 2 3 4 5 6 7 8]</span><br><span class="line">9       cap=16  [0 1 2 3 4 5 6 7 8 9]</span><br></pre></td></tr></tbody></table></figure>

<p>当切片容量不足以容纳更多元素时，Go的容量将翻倍。这意味着将新建一个具有新容量的的基础数组。无需执行任何操作即可使容量增加。Go会自动扩充容量。需要谨慎操作，因为有时一个切片具有的容量可能比它需要的多得多，这样会浪费内存。</p>
<h5 id="删除项"><a href="#删除项" class="headerlink" title="删除项"></a>删除项</h5><p>Go中没有内置函数用于从切片中删除元素。可使用切片运算符<code>s[i:j]</code>来新建一个仅包含所需元素的切片。如下所示：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    letters := []<span class="keyword">string</span>{<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>}</span><br><span class="line">    remove := <span class="number">2</span></span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">"Before"</span>, letters)</span><br><span class="line"></span><br><span class="line">    letters[remove] = letters[<span class="built_in">len</span>(letters)<span class="number">-1</span>]</span><br><span class="line">    letters = letters[:<span class="built_in">len</span>(letters)<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">"After"</span>, letters)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出如下：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Before [A B C D E]</span><br><span class="line">After [A B E D]</span><br></pre></td></tr></tbody></table></figure>

<h5 id="创建切片的副本"><a href="#创建切片的副本" class="headerlink" title="创建切片的副本"></a>创建切片的副本</h5><p>Go具有内置函数<code>copy(dst, src []Type)</code>用于创建切片的副本。如下创建一个切片副本：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">slice2 := <span class="built_in">make</span>([]<span class="keyword">string</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">copy</span>(slice2, letters[<span class="number">1</span>:<span class="number">4</span>])</span><br></pre></td></tr></tbody></table></figure>

<p>为何要创建副本？ 更改切片中的元素时，基础数组将随之更改。 引用该基础数组的任何其他切片都会受到影响。</p>
<p>使用下述代码确认切片指向数组，而在切片中所做的每个更改都会影响基础数组。</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    letters := []<span class="keyword">string</span>{<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>}</span><br><span class="line">    fmt.Println(<span class="string">"Before"</span>, letters)</span><br><span class="line"></span><br><span class="line">    slice1 := letters[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">    slice2 := letters[<span class="number">1</span>:<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">    slice1[<span class="number">1</span>] = <span class="string">"Z"</span></span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">"After"</span>, letters)</span><br><span class="line">    fmt.Println(<span class="string">"Slice2"</span>, slice2)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出如下：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Before [A B C D E]</span><br><span class="line">After [A Z C D E]</span><br><span class="line">Slice2 [Z C D]</span><br></pre></td></tr></tbody></table></figure>

<p>若要解决此问题，需要创建一个切片副本，它会在后台生成新的基础数组。 可以使用以下代码：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    letters := []<span class="keyword">string</span>{<span class="string">"A"</span>, <span class="string">"B"</span>, <span class="string">"C"</span>, <span class="string">"D"</span>, <span class="string">"E"</span>}</span><br><span class="line">    fmt.Println(<span class="string">"Before"</span>, letters)</span><br><span class="line"></span><br><span class="line">    slice1 := letters[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">    slice2 := <span class="built_in">make</span>([]<span class="keyword">string</span>, <span class="number">3</span>)</span><br><span class="line">    <span class="built_in">copy</span>(slice2, letters[<span class="number">1</span>:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">    slice1[<span class="number">1</span>] = <span class="string">"Z"</span></span><br><span class="line"></span><br><span class="line">    fmt.Println(<span class="string">"After"</span>, letters)</span><br><span class="line">    fmt.Println(<span class="string">"Slice2"</span>, slice2)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>运行上述代码时，会看到以下输出：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Before [A B C D E]</span><br><span class="line">After [A Z C D E]</span><br><span class="line">Slice2 [B C D]</span><br></pre></td></tr></tbody></table></figure>

<h4 id="映射"><a href="#映射" class="headerlink" title="映射"></a>映射</h4><p>Go中映射是一个哈希表，是键值对的集合。映射中的所有键都必须具有相同的类型，值也是如此。不过键和值的类型可以不相同。</p>
<h5 id="声明和初始化映射"><a href="#声明和初始化映射" class="headerlink" title="声明和初始化映射"></a>声明和初始化映射</h5><p>使用<code>map</code>关键字进行声明映射。然后定义键和值类型，比如<code>map[T]T</code>。示例如下：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    studentsAge := <span class="keyword">map</span>[<span class="keyword">string</span>] <span class="keyword">int</span>{</span><br><span class="line">        <span class="string">"john"</span>: <span class="number">32</span>,</span><br><span class="line">        <span class="string">"bob"</span>: <span class="number">31</span>,</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    fmt.Println(studentsAge)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>运行代码输出如下：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">map[bob:31, john:32]</span><br></pre></td></tr></tbody></table></figure>

<p>如果不想初始化映射，可以使用内置函数<code>make</code>创建空映射：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">studentsAge := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>映射是动态的，创建后，可以添加、访问和删除这些项。</p>
<h5 id="添加项"><a href="#添加项" class="headerlink" title="添加项"></a>添加项</h5><p>要添加想，无需向切片一样使用内置函数，只需要定义键和值即可。如果没有键值对，则会添加到映射中。</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    studentsAge := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br><span class="line">    studentsAge[<span class="string">"john"</span>] = <span class="number">32</span></span><br><span class="line">    studentsAge[<span class="string">"bob"</span>] = <span class="number">31</span></span><br><span class="line">    fmt.Println(studentsAge)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>如果尝试使用<code>nil</code>映射（也就是不使用<code>make</code>进行创建的映射，而是直接使用 <code>map[T]T</code>进行声明），会出现错误。例如，以下代码将不起作用：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    <span class="keyword">var</span> studentsAge <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span></span><br><span class="line">    studentsAge[<span class="string">"john"</span>] = <span class="number">32</span></span><br><span class="line">    studentsAge[<span class="string">"bob"</span>] = <span class="number">31</span></span><br><span class="line">    fmt.Println(studentsAge) <span class="comment">// 运行时会报错</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>为了避免出现以上操作<code>nil</code>映射的错误，一定要确保使用<code>make</code>创建一个空映射。</p>
<h5 id="访问项"><a href="#访问项" class="headerlink" title="访问项"></a>访问项</h5><p>要访问映射中的项，常用的方式是<code>m[key]</code>。如下所示：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    studentsAge := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br><span class="line">    studentsAge[<span class="string">"john"</span>] = <span class="number">32</span></span><br><span class="line">    studentsAge[<span class="string">"bob"</span>] = <span class="number">31</span></span><br><span class="line">    fmt.Println(<span class="string">"Bob's age is "</span>, studentsAge[<span class="string">"bob"</span>])</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>在映射中使用下标表示法时，即使映射中没有键，也总会获得响应。 当访问不存在的项时，Go 不会执行 panic。 此时，会获得默认值。 可使用以下代码来确认该行为：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    studentsAge := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br><span class="line">    studentsAge[<span class="string">"john"</span>] = <span class="number">32</span></span><br><span class="line">    studentsAge[<span class="string">"bob"</span>] = <span class="number">31</span></span><br><span class="line">    fmt.Println(<span class="string">"Christy's age is"</span>, studentsAge[<span class="string">"christy"</span>]) <span class="comment">// 输出为0</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>在很多情况下，访问映射中没有的项时 Go 不会返回错误，这是正常的。 但有时需要知道某个项是否存在。 在 Go 中，映射的下标表示法可生成两个值。 第一个是项的值。 第二个是指示键是否存在的布尔型标志。</p>
<p>若要解决上一代码片段遇到的问题，可执行以下代码：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    studentsAge := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br><span class="line">    studentsAge[<span class="string">"john"</span>] = <span class="number">32</span></span><br><span class="line">    studentsAge[<span class="string">"bob"</span>] = <span class="number">31</span></span><br><span class="line"></span><br><span class="line">    age, exist := studentsAge[<span class="string">"christy"</span>]</span><br><span class="line">    <span class="keyword">if</span> exist {</span><br><span class="line">        fmt.Println(<span class="string">"Christy's age is"</span>, age) <span class="comment">// 运行时输出这句话</span></span><br><span class="line">    } <span class="keyword">else</span> {</span><br><span class="line">        fmt.Println(<span class="string">"Christy's age couldn't be found"</span>)</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h5 id="删除项-1"><a href="#删除项-1" class="headerlink" title="删除项"></a>删除项</h5><p>从映射中删除项，使用内置函数<code>delete()</code>。</p>
<p>示例：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    studentsAge := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br><span class="line">    studentsAge[<span class="string">"john"</span>] = <span class="number">32</span></span><br><span class="line">    studentsAge[<span class="string">"bob"</span>] = <span class="number">31</span></span><br><span class="line">    <span class="built_in">delete</span>(studentsAge, <span class="string">"john"</span>)</span><br><span class="line">    fmt.Println(studentsAge)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>尝试删除不存在的项，Go 不会执行 panic。</p>
<h5 id="映射中的循环"><a href="#映射中的循环" class="headerlink" title="映射中的循环"></a>映射中的循环</h5><figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    studentsAge := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br><span class="line">    studentsAge[<span class="string">"john"</span>] = <span class="number">32</span></span><br><span class="line">    studentsAge[<span class="string">"bob"</span>] = <span class="number">31</span></span><br><span class="line">    <span class="keyword">for</span> name, age := <span class="keyword">range</span> studentsAge {</span><br><span class="line">        fmt.Printf(<span class="string">"%s\t%d\n"</span>, name, age)</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>输出如下：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">john    32</span><br><span class="line">bob     31</span><br></pre></td></tr></tbody></table></figure>

<p><code>range</code>会首先生成项的键，然后再生成该项的值。可使用<code>_</code>变量忽略其中任何一个，如下所示：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    studentsAge := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br><span class="line">    studentsAge[<span class="string">"john"</span>] = <span class="number">32</span></span><br><span class="line">    studentsAge[<span class="string">"bob"</span>] = <span class="number">31</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _, age := <span class="keyword">range</span> studentsAge {</span><br><span class="line">        fmt.Printf(<span class="string">"Ages %d\n"</span>, age)</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>如果需要键值，直接使用一个变量就行。</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    studentsAge := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">int</span>)</span><br><span class="line">    studentsAge[<span class="string">"john"</span>] = <span class="number">32</span></span><br><span class="line">    studentsAge[<span class="string">"bob"</span>] = <span class="number">31</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> name := <span class="keyword">range</span> studentsAge {</span><br><span class="line">        fmt.Printf(<span class="string">"Names %s\n"</span>, name)</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>


<h4 id="结构体"><a href="#结构体" class="headerlink" title="结构体"></a>结构体</h4><p>有时，需要在一个结构中表示字段的集合。在Go中，可使用结构体将可能构成记录的不同字段组合在一起。</p>
<p>结构体可以包含零个或多个任意类型的字段，并将其表示为单个实体。</p>
<h5 id="声明和初始化结构"><a href="#声明和初始化结构" class="headerlink" title="声明和初始化结构"></a>声明和初始化结构</h5><p>若要声明结构体，需要使用<code>struct</code>关键字，还要使用希望新的数据类型具有的字段及其类型的列表，字段也可以是另一个结构体类型。例如，定义员工结构体：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Employee <span class="keyword">struct</span> {</span><br><span class="line">    ID <span class="keyword">int</span></span><br><span class="line">    FirstName <span class="keyword">string</span></span><br><span class="line">    LastName <span class="keyword">string</span></span><br><span class="line">    Address <span class="keyword">string</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>然后就可以向操作其他类型一样使用新类型声明一个变量。</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> john Employee</span><br></pre></td></tr></tbody></table></figure>

<p>如果要在声明结构体变量时对其进行初始化，可按以下方式操作：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">employee := Employee{<span class="number">1001</span>, <span class="string">"John"</span>, <span class="string">"Doe"</span>, <span class="string">"Doe's Street"</span>}</span><br><span class="line"><span class="comment">// 或指定字段名，这是顺序不重要</span></span><br><span class="line">employee2 := Employee(ID:<span class="number">1002</span>, LastName:<span class="string">"Joe"</span>, FirstName:<span class="string">"King"</span>, Address: <span class="string">"xxx"</span>)</span><br></pre></td></tr></tbody></table></figure>

<p>必须为结构体中的每个字段指定一个值。访问结构体的字段是使用点<code>.</code>表示法即可。</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">employee.ID = <span class="number">1001</span></span><br><span class="line">fmt.Prinlnt(employee.FirstName)</span><br></pre></td></tr></tbody></table></figure>

<p>可以使用<code>&amp;</code>运算符生成指向结构体的指针，如下所示：</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Employee <span class="keyword">struct</span> {</span><br><span class="line">    ID        <span class="keyword">int</span></span><br><span class="line">    FirstName <span class="keyword">string</span></span><br><span class="line">    LastName  <span class="keyword">string</span></span><br><span class="line">    Address   <span class="keyword">string</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    employee := Employee{LastName: <span class="string">"Doe"</span>, FirstName: <span class="string">"John"</span>}</span><br><span class="line">    fmt.Println(employee)</span><br><span class="line">    employeeCopy := &amp;employee</span><br><span class="line">    employeeCopy.FirstName = <span class="string">"David"</span></span><br><span class="line">    fmt.Println(employee)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>运行后输入如下：</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">{0 John Doe }</span><br><span class="line">{0 David Doe }</span><br></pre></td></tr></tbody></table></figure>

<h5 id="用JSON编码和解码结构体"><a href="#用JSON编码和解码结构体" class="headerlink" title="用JSON编码和解码结构体"></a>用JSON编码和解码结构体</h5><p>Go对JSON格式提供很好的支持，已包含在标准包中。</p>
<p>若要将结构体编码为<code>JSON</code>，使用<code>json.Marshal</code>函数。如果要将<code>JSON</code>字符串解码为数据结构，使用<code>json.Unmarshal</code>函数。</p>
<figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">    <span class="string">"encoding/json"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Person <span class="keyword">struct</span> {</span><br><span class="line">    ID        <span class="keyword">int</span></span><br><span class="line">    FirstName <span class="keyword">string</span> <span class="string">`json:"name"`</span></span><br><span class="line">    LastName  <span class="keyword">string</span></span><br><span class="line">    Address   <span class="keyword">string</span> <span class="string">`json:"address,omitempty"`</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Employee <span class="keyword">struct</span> {</span><br><span class="line">    Person</span><br><span class="line">    ManagerID <span class="keyword">int</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Contractor <span class="keyword">struct</span> {</span><br><span class="line">    Person</span><br><span class="line">    CompanyID <span class="keyword">int</span></span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    employees := []Employee{</span><br><span class="line">        Employee{</span><br><span class="line">            Person: Person{</span><br><span class="line">                LastName: <span class="string">"Doe"</span>, FirstName: <span class="string">"John"</span>,</span><br><span class="line">            },</span><br><span class="line">        },</span><br><span class="line">        Employee{</span><br><span class="line">            Person: Person{</span><br><span class="line">                LastName: <span class="string">"Campbell"</span>, FirstName: <span class="string">"David"</span>,</span><br><span class="line">            },</span><br><span class="line">        },</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    data, _ := json.Marshal(employees)</span><br><span class="line">    fmt.Printf(<span class="string">"%s\n"</span>, data)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> decoded []Employee</span><br><span class="line">    json.Unmarshal(data, &amp;decoded)</span><br><span class="line">    fmt.Printf(<span class="string">"%v"</span>, decoded)</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h4 id="挑战"><a href="#挑战" class="headerlink" title="挑战"></a>挑战</h4><h5 id="计算斐波拉契数"><a href="#计算斐波拉契数" class="headerlink" title="计算斐波拉契数"></a>计算斐波拉契数</h5><figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">"fmt"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">fibonaci</span><span class="params">(n <span class="keyword">int</span>)</span> []<span class="title">int</span></span> {</span><br><span class="line">    <span class="keyword">if</span> n&lt;<span class="number">2</span> {</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="number">0</span>)</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    nums := <span class="built_in">make</span>([]<span class="keyword">int</span>, n)</span><br><span class="line">    nums[<span class="number">0</span>], nums[<span class="number">1</span>] = <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> i:=<span class="number">2</span>, i&lt;n; i++ {</span><br><span class="line">        nums[i] = nums[i<span class="number">-1</span>]+nums[i<span class="number">-2</span>]</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> nums</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    <span class="keyword">var</span> num <span class="keyword">int</span></span><br><span class="line"></span><br><span class="line">    fmt.Print(<span class="string">"What's the Fibonacci sequence you want? "</span>)</span><br><span class="line">    fmt.Scanln(&amp;num)</span><br><span class="line">    fmt.Println(<span class="string">"The Fibonacci sequence is:"</span>, fibonacci(num))</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h5 id="罗马数字转换器"><a href="#罗马数字转换器" class="headerlink" title="罗马数字转换器"></a>罗马数字转换器</h5><figure class="highlight golang"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">"fmt"</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">romanToArabic</span><span class="params">(numeral <span class="keyword">string</span>)</span> <span class="title">int</span></span> {</span><br><span class="line">    romanMap := <span class="keyword">map</span>[<span class="keyword">rune</span>]<span class="keyword">int</span>{</span><br><span class="line">        <span class="string">'M'</span>: <span class="number">1000</span>,</span><br><span class="line">        <span class="string">'D'</span>: <span class="number">500</span>,</span><br><span class="line">        <span class="string">'C'</span>: <span class="number">100</span>,</span><br><span class="line">        <span class="string">'L'</span>: <span class="number">50</span>,</span><br><span class="line">        <span class="string">'X'</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="string">'V'</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="string">'I'</span>: <span class="number">1</span>,</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    arabicVals := <span class="built_in">make</span>([]<span class="keyword">int</span>, <span class="built_in">len</span>(numeral)+<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> index, digit := <span class="keyword">range</span> numeral {</span><br><span class="line">        <span class="keyword">if</span> val, present := romanMap[digit]; present {</span><br><span class="line">            arabicVals[index] = val</span><br><span class="line">        } <span class="keyword">else</span> {</span><br><span class="line">            fmt.Printf(<span class="string">"Error: The roman numeral %s has a bad digit: %c\n"</span>, numeral, digit)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    total := <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> index := <span class="number">0</span>; index &lt; <span class="built_in">len</span>(numeral); index++ {</span><br><span class="line">        <span class="keyword">if</span> arabicVals[index] &lt; arabicVals[index+<span class="number">1</span>] {</span><br><span class="line">            arabicVals[index] = -arabicVals[index]</span><br><span class="line">        }</span><br><span class="line">        total += arabicVals[index]</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> total</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> {</span><br><span class="line">    fmt.Println(<span class="string">"MCLX is"</span>, romanToArabic(<span class="string">"MCLX"</span>))</span><br><span class="line">    fmt.Println(<span class="string">"MCMXCIX is "</span>, romanToArabic(<span class="string">"MCMXCIX"</span>))</span><br><span class="line">    fmt.Println(<span class="string">"MCMZ is"</span>, romanToArabic(<span class="string">"MCMZ"</span>))</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
        </div>

        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/ckmp12ga20006ejx9fo3u91x3.html"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Go方法和接口</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/ckmp12ga10005ejx90lx5ekz0.html"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">Go控制流</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>&nbsp;-&nbsp;
            
            2021&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">Fors3c</a>
        </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.1</a>
        </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="fas fa-arrow-up"></i>
            </li>
        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
    </ul>
</div>

    </div>

    

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>



<script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/header-shrink.js"></script><script src="/js/back2top.js"></script><script src="/js/dark-light-toggle.js"></script>







<div class="post-scripts">
    
</div>



<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
